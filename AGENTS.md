# Repository Guidelines

## Project Structure & Module Organization
The crate lives in `src/lib.rs`, exporting the decoder/encoder APIs that forbid `unsafe` usage. Examples reside in `examples/` (see `play.rs` for audio playback), reusable fixtures in `fixtures/`, microbenchmarks in `benches/`, and libFuzzer harnesses in `fuzz/`. Rust integration files generated by Cargo land under `target/`; never commit that directory. Audio assets for manual testing should stay in `fixtures/` to keep paths consistent.

## Build, Test, and Development Commands
Use `cargo build` for debug builds and `cargo build --release` when profiling. Run `cargo run --example play --features rodio -- fixtures/sample.qoa` to audition playback; the `rodio` feature is optional elsewhere. Execute `cargo bench` for Criterion benchmarks and `cargo fuzz run iter_all` after installing `cargo-fuzz` to validate decoder robustness.

## Coding Style & Naming Conventions
Follow default Rust formatting (`rustfmt` 4-space indentation). Always run `cargo fmt` before committing. Prefer `snake_case` for modules/functions, `UpperCamelCase` for types/enums, and `SCREAMING_SNAKE_CASE` for constants such as `QOA_MAGIC`. Keep public API docs concise and adjust doc examples to compile under `cargo test`. Avoid introducing `unsafe`; the crate enforces this at the crate root.

## Testing Guidelines
Add unit tests alongside the relevant module and keep integration-style checks in `tests/` if they grow beyond fixtures. Run `cargo test --all-features` before opening a PR. Property or fuzz tests belong under `fuzz/fuzz_targets/`; reuse fixture audio for deterministic assertions. Target at least the existing coverage footprint—any new surface should include decoding or encoding assertions.

## Commit & Pull Request Guidelines
Commit messages are imperative (e.g., `Add QOA encoder implementation`) and may use conventional prefixes (`chore:`, `fix:`) when helpful. Keep commits focused and include motivation in the body if behavior changes. Pull requests should link issues when applicable, describe user-visible effects, list validation commands, and attach audio output notes or screenshots if behavior differs.

## Fuzzing & Benchmarks
`cargo bench` reports throughput for `fixtures/julien_baker_sprained_ankle.qoa`; update assertions if fixture changes. Fuzzing depends on an LLVM-based toolchain—document the toolchain in the PR when adding new targets. Treat crashes or new corpus discoveries as security-sensitive until triaged.
